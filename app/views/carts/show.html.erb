<!-- views/carts/show.html.erb -->
<h1>Your Cart</h1>

<% if session[:cart].empty? %>
  <p>Your cart is empty.</p>
<% else %>
  <table>
    <% session[:cart].each do |item| %>
      <% product = Product.find(item["product_id"]) %>
      <tr>
        <td><%= product.name %></td>
        <td>
          <%= form_with url: update_cart_item_path(product_id: product.id), method: :patch do |f| %>
            <%= f.number_field :quantity, value: item["quantity"], min: 0, max: product.quantity_available, step: 1 %>
            <%= f.submit "Update" %>
          <% end %>
        </td>
        <td><%= link_to 'Remove', remove_from_cart_path(product_id: product.id), method: :delete %></td>
      </tr>
    <% end %>
  </table>
  <p>Total Price: <%= number_to_currency(@total_price) %></p>

  <!-- Temporarily comment out the Checkout link -->
  <%# <%= link_to 'Checkout', checkout_path %>
<%= link_to 'Checkout', initiate_checkout_path, class: 'button is-primary' %>
<% end %>